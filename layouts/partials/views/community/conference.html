{{/* è·å–ä¼ å…¥çš„é¡¹ç›®æ•°æ® */}}
{{ $items := .item }}
{{ if not $items }}
  {{ $items = .Items }}
{{ end }}

{{ if $items }}
  {{/* æŒ‰å¹´ä»½åˆ†ç»„ä¼šè®®æ•°æ® */}}
  {{ $grouped := dict }}
  {{ $years := slice }}
  
  {{ range $items }}
    {{ $year := (time .Date).Format "2006" }}
    {{ $currentYearItems := index $grouped $year | default slice }}
    {{ $grouped = merge $grouped (dict $year ($currentYearItems | append .)) }}
    {{ if not (in $years $year) }}
      {{ $years = $years | append $year }}
    {{ end }}
  {{ end }}

  {{/* æŒ‰å¹´ä»½å€’åºæ’åˆ— */}}
  {{ $sortedYears := sort $years "desc" }}

  {{/* æ¸²æŸ“æ¯å¹´çš„ä¼šè®® */}}
  {{ range $year := $sortedYears }}
    <h2 class="text-lg font-semibold mt-6 mb-2 border-b border-gray-300 pb-1">{{ $year }}</h2>
    <ul class="list-disc list-inside space-y-2">
      {{ range index $grouped $year }}
        <li>
          <span class="font-semibold">{{ .Title }}</span>
          {{ with .Params.event }}
            â€” <em>{{ . }}</em>
          {{ end }}
          <br>
          {{ with .Params.location }}
            ğŸ“ {{ . }}
          {{ end }}
          {{ with .Date }}
            Â· {{ dateFormat "January 2, 2006" . }}
          {{ end }}
          {{ if and .Params.date_end (ne .Date .Params.date_end) }}
            {{ $endDate := time .Params.date_end }}
            - {{ dateFormat "January 2, 2006" $endDate }}
          {{ end }}
          <br>
          {{ with .Params.presentation }}
            <span class="inline-block bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded">{{ . }}</span>
          {{ end }}
        </li>
      {{ end }}
    </ul>
  {{ end }}
{{ else }}
  <div class="bg-yellow-50 border border-yellow-200 rounded p-4">
    <p class="text-yellow-800">æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ä¼šè®®è®°å½•ã€‚</p>
    <p class="text-sm text-yellow-600 mt-2">è¯·ç¡®ä¿ï¼š</p>
    <ul class="list-disc list-inside text-sm text-yellow-600">
      <li>content/talk/ ç›®å½•ä¸­æœ‰å†…å®¹æ–‡ä»¶</li>
      <li>å†…å®¹æ–‡ä»¶åŒ…å«å¿…è¦çš„ front matter</li>
      <li>æ–‡ä»¶æ²¡æœ‰è®¾ç½® draft: true</li>
    </ul>
  </div>
{{ end }}
